<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Apartments in Rome ‚Äî BOOM</title>
    <meta name="description" content="Browse video-verified apartments for rent in Rome. Updated daily. No hidden fees. Move in within 48 hours.">
    <link rel="icon" type="image/png" href="https://www.boomrome.com/BOOMlogogoldicon512.png">
    <link rel="apple-touch-icon" href="https://www.boomrome.com/BOOMlogogoldicon512.png">
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-EYCD59RDVJ"></script>
    <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date());gtag('config','G-EYCD59RDVJ');</script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@200;300;400;500;600&display=swap" rel="stylesheet">
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        :root{--gold:#FFD700;--pure-black:#000;--dark-void:#0A0A0A;--text-primary:#fff;--text-secondary:rgba(255,255,255,0.7);--text-fade:rgba(255,255,255,0.4)}
        body{font-family:'Inter',-apple-system,sans-serif;background:var(--pure-black);color:var(--text-primary);font-weight:300;line-height:1.6;-webkit-font-smoothing:antialiased}
        a{text-decoration:none;color:inherit}

        /* NAV */
        nav{position:fixed;width:100%;top:0;z-index:100;padding:20px 50px;background:rgba(0,0,0,0.98);backdrop-filter:blur(20px);border-bottom:1px solid rgba(255,215,0,0.1)}
        .nav-container{max-width:1400px;margin:0 auto;display:flex;justify-content:space-between;align-items:center}
        .logo{display:flex;align-items:center;gap:15px;text-decoration:none;color:#fff}
        .logo-svg{width:80px;height:80px;filter:drop-shadow(0 0 20px rgba(255,215,0,0.5));transition:filter .3s}
        .logo:hover .logo-svg{filter:drop-shadow(0 0 35px rgba(255,215,0,0.8))}
        .logo-text{font-family:'Helvetica Neue',Helvetica,Arial,sans-serif;font-size:32px;font-weight:300;letter-spacing:4px;text-transform:uppercase}
        .nav-links{display:flex;gap:30px;align-items:center}
        .nav-links a{color:rgba(255,255,255,0.6);text-decoration:none;font-size:13px;font-weight:300;text-transform:uppercase;letter-spacing:1px;transition:color .3s}
        .nav-links a:hover,.nav-links a.active{color:var(--gold)}
        .wa-link{color:#25D366!important}
        .hamburger{display:none;flex-direction:column;gap:5px;cursor:pointer;padding:10px;z-index:101}
        .hamburger span{display:block;width:24px;height:2px;background:#fff;transition:.3s}
        @media(max-width:768px){
            nav{padding:15px 20px}
            .nav-links{display:none}
            .hamburger{display:flex}
            .logo-svg{width:45px;height:45px}
            .logo-text{font-size:22px;letter-spacing:2px}
        }
        .mobile-menu{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.98);z-index:99;display:none;flex-direction:column;justify-content:center;align-items:center;gap:28px}
        .mobile-menu.open{display:flex}
        .mobile-menu a{color:rgba(255,255,255,0.6);font-size:18px;font-weight:300;text-transform:uppercase;letter-spacing:2px;transition:color .3s}
        .mobile-menu a:hover{color:var(--gold)}
        .wa-mob{color:#25D366!important;border:1px solid #25D366;padding:12px 28px;border-radius:30px;margin-top:10px}

        /* PAGE */
        .page{max-width:1400px;margin:0 auto;padding:140px 40px 80px}
        @media(max-width:768px){.page{padding:120px 20px 60px}}

        .page-header{text-align:center;margin-bottom:50px}
        .page-tag{display:inline-block;font-size:11px;text-transform:uppercase;letter-spacing:3px;color:var(--gold);margin-bottom:12px}
        .page-title{font-family:'Helvetica Neue',Helvetica,Arial,sans-serif;font-size:clamp(32px,5vw,56px);font-weight:200;line-height:1.1;margin-bottom:16px}
        .page-subtitle{font-size:16px;color:var(--text-secondary);max-width:600px;margin:0 auto}

        /* FILTERS */
        .filters{display:flex;justify-content:center;gap:12px;margin-bottom:40px;flex-wrap:wrap}
        .filter-btn{padding:10px 24px;border-radius:30px;border:1px solid rgba(255,255,255,0.1);background:transparent;color:var(--text-secondary);font-family:inherit;font-size:13px;font-weight:400;cursor:pointer;transition:all .3s}
        .filter-btn:hover{border-color:rgba(255,215,0,0.3);color:var(--text-primary)}
        .filter-btn.active{background:var(--gold);color:#000;border-color:var(--gold);font-weight:600}
        .filter-count{margin-left:6px;opacity:.6}

        /* GRID */
        .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(340px,1fr));gap:24px}
        @media(max-width:768px){.grid{grid-template-columns:1fr;gap:20px}}

        /* CARD */
        .card{background:var(--dark-void);border:1px solid rgba(255,255,255,0.06);border-radius:20px;overflow:hidden;transition:all .4s;cursor:pointer;display:flex;flex-direction:column}
        .card:hover{transform:translateY(-4px);border-color:rgba(255,215,0,0.15);box-shadow:0 20px 60px rgba(0,0,0,0.5)}
        .card-img{width:100%;height:220px;background-size:cover;background-position:center;background-color:#111;position:relative}
        .card-badges{position:absolute;top:14px;left:14px;display:flex;gap:8px;flex-wrap:wrap}
        .badge{padding:5px 12px;border-radius:20px;font-size:10px;font-weight:600;text-transform:uppercase;letter-spacing:.5px;backdrop-filter:blur(10px)}
        .badge-available{background:rgba(0,255,136,0.15);color:#00FF88;border:1px solid rgba(0,255,136,0.2)}
        .badge-waitlist{background:rgba(255,149,0,0.15);color:#FF9500;border:1px solid rgba(255,149,0,0.2)}
        .badge-verified{background:rgba(255,255,255,0.08);color:rgba(255,255,255,0.7);border:1px solid rgba(255,255,255,0.1)}
        .badge-video{background:rgba(255,59,48,0.15);color:#FF3B30;border:1px solid rgba(255,59,48,0.2)}
        .card-body{padding:22px 24px 24px;flex:1;display:flex;flex-direction:column}
        .card-zone{font-size:11px;text-transform:uppercase;letter-spacing:2px;color:var(--gold);margin-bottom:6px}
        .card-name{font-size:20px;font-weight:400;margin-bottom:10px;color:#fff}
        .card-specs{display:flex;gap:16px;font-size:13px;color:var(--text-secondary);margin-bottom:16px;flex-wrap:wrap}
        .card-specs span{display:flex;align-items:center;gap:5px}
        .card-tags{display:flex;gap:6px;flex-wrap:wrap;margin-bottom:16px}
        .card-tag{padding:4px 10px;border-radius:6px;font-size:10px;background:rgba(255,255,255,0.04);color:var(--text-fade);border:1px solid rgba(255,255,255,0.04)}
        .card-bottom{display:flex;justify-content:space-between;align-items:center;margin-top:auto;padding-top:16px;border-top:1px solid rgba(255,255,255,0.06)}
        .card-price{font-size:24px;font-weight:200;color:var(--gold)}
        .card-price small{font-size:12px;color:var(--text-fade);font-weight:300}
        .card-cta{padding:10px 20px;border-radius:10px;font-size:12px;font-weight:600;text-transform:uppercase;letter-spacing:.5px;background:rgba(255,255,255,0.06);color:var(--text-secondary);transition:all .3s;border:1px solid rgba(255,255,255,0.06)}
        .card:hover .card-cta{background:var(--gold);color:#000;border-color:var(--gold)}
        .card-avail{font-size:11px;color:var(--text-fade);margin-top:8px}

        /* LOADING / EMPTY */
        .loading-state{text-align:center;padding:80px 20px}
        .spinner{width:40px;height:40px;border:3px solid rgba(255,255,255,0.1);border-top-color:var(--gold);border-radius:50%;animation:spin .8s linear infinite;margin:0 auto 20px}
        @keyframes spin{to{transform:rotate(360deg)}}
        .empty-state{text-align:center;padding:80px 20px}
        .empty-state h3{font-size:24px;font-weight:200;margin-bottom:12px}
        .empty-state p{color:var(--text-secondary);margin-bottom:24px}

        /* UPSELL SECTION */
        .upsell-section{margin-top:80px}
        .upsell-header{text-align:center;margin-bottom:48px}
        .upsell-tag{display:inline-block;padding:8px 20px;background:var(--gold);color:#000;font-size:10px;font-weight:700;letter-spacing:2px;text-transform:uppercase;margin-bottom:20px}
        .upsell-title{font-family:'Helvetica Neue',Helvetica,Arial,sans-serif;font-size:clamp(26px,4vw,44px);font-weight:200;margin-bottom:12px}
        .upsell-subtitle{font-size:15px;color:var(--text-secondary);max-width:520px;margin:0 auto;line-height:1.6}

        .notify-banner{background:linear-gradient(135deg,rgba(255,215,0,0.05) 0%,rgba(0,206,209,0.04) 100%);border:1px solid rgba(255,215,0,0.12);border-radius:20px;padding:32px 36px;margin-bottom:32px;display:flex;align-items:center;gap:28px;transition:border-color .3s}
        .notify-banner:hover{border-color:rgba(255,215,0,0.25)}
        .notify-icon{width:56px;height:56px;background:rgba(255,215,0,0.08);border-radius:16px;display:flex;align-items:center;justify-content:center;font-size:24px;flex-shrink:0}
        .notify-text{flex:1}
        .notify-text h3{font-size:17px;font-weight:500;margin-bottom:4px}
        .notify-text p{font-size:13px;color:var(--text-secondary);line-height:1.5}
        .notify-actions{display:flex;gap:10px;flex-shrink:0}
        .notify-actions .nbtn{padding:12px 24px;border-radius:10px;font-family:inherit;font-size:13px;font-weight:600;cursor:pointer;transition:all .3s;text-decoration:none;display:inline-flex;align-items:center;gap:8px;white-space:nowrap;border:none}
        .nbtn-primary{background:var(--gold);color:#000}
        .nbtn-primary:hover{box-shadow:0 6px 24px rgba(255,215,0,0.25);transform:translateY(-1px)}
        .nbtn-wa{background:#25D366;color:#fff}
        .nbtn-wa:hover{box-shadow:0 6px 24px rgba(37,211,102,0.25);transform:translateY(-1px)}
        @media(max-width:900px){.notify-banner{flex-direction:column;text-align:center;gap:18px;padding:28px 24px}.notify-actions{width:100%;flex-direction:column}.notify-actions .nbtn{justify-content:center}}

        /* VIDEO ‚Äî LIVING PHONE (Ultra Premium) */
        .video-showcase{display:flex;align-items:center;gap:48px;margin-bottom:40px;padding:40px;background:linear-gradient(135deg,rgba(255,215,0,0.03) 0%,rgba(0,0,0,0.2) 50%,rgba(255,215,0,0.02) 100%);border:1px solid rgba(255,215,0,0.06);border-radius:24px;position:relative;overflow:hidden;opacity:0;transform:translateY(20px);transition:opacity .8s ease,transform .8s ease}
        .video-showcase.visible{opacity:1;transform:translateY(0)}
        .video-showcase::before{content:'';position:absolute;top:-50%;right:-20%;width:400px;height:400px;background:radial-gradient(circle,rgba(255,215,0,0.04) 0%,transparent 70%);pointer-events:none;animation:ambientDrift 12s infinite ease-in-out}
        @keyframes ambientDrift{0%,100%{transform:translate(0,0)}25%{transform:translate(-20px,15px)}50%{transform:translate(10px,-10px)}75%{transform:translate(-10px,-20px)}}
        .video-copy{flex:1;z-index:1}
        .video-copy .vc-tag{display:inline-flex;align-items:center;gap:6px;padding:6px 14px;background:rgba(255,215,0,0.08);border:1px solid rgba(255,215,0,0.12);border-radius:20px;font-size:10px;font-weight:600;letter-spacing:1px;text-transform:uppercase;color:var(--gold);margin-bottom:16px}
        .video-copy .vc-tag .pulse{width:6px;height:6px;background:var(--gold);border-radius:50%;animation:livePulse 2s infinite}
        @keyframes livePulse{0%,100%{opacity:1;transform:scale(1)}50%{opacity:.4;transform:scale(.8)}}
        .video-copy h3{font-size:22px;font-weight:300;margin-bottom:8px;line-height:1.3}
        .video-copy h3 strong{font-weight:500;color:var(--gold)}
        .video-copy p{font-size:14px;color:var(--text-secondary);line-height:1.6;max-width:380px;margin-bottom:20px}
        .video-copy .vc-stats{display:flex;gap:24px}
        .video-copy .vc-stat{font-size:11px;color:var(--text-fade);display:flex;align-items:center;gap:5px}
        .video-copy .vc-stat span{color:var(--gold);font-weight:600;font-size:13px}
        .video-device{position:relative;flex-shrink:0;cursor:pointer}
        .video-device:hover .vd-glow{opacity:.9;transform:scale(1.15)}
        .video-device:hover .vd-frame{border-color:rgba(255,215,0,0.25);transform:translateY(-6px) scale(1.02)}
        /* Glow ‚Äî breathing gold aura */
        .vd-glow{position:absolute;inset:-35px;background:radial-gradient(ellipse,rgba(255,215,0,0.12) 0%,rgba(255,215,0,0.04) 40%,transparent 70%);border-radius:50%;opacity:.3;transition:all .8s cubic-bezier(.25,.46,.45,.94);filter:blur(25px);animation:glowBreath 4s infinite ease-in-out;pointer-events:none}
        .video-device.playing .vd-glow{opacity:.7;animation:glowBreathPlaying 3s infinite ease-in-out}
        @keyframes glowBreath{0%,100%{opacity:.3;transform:scale(1)}50%{opacity:.5;transform:scale(1.04)}}
        @keyframes glowBreathPlaying{0%,100%{opacity:.5;transform:scale(1)}50%{opacity:.75;transform:scale(1.08)}}
        /* Phone frame */
        .vd-frame{width:160px;height:284px;border-radius:24px;border:2px solid rgba(255,255,255,0.08);background:#000;overflow:hidden;position:relative;box-shadow:0 12px 50px rgba(0,0,0,0.5),0 0 0 1px rgba(255,255,255,0.03);transition:all .5s cubic-bezier(.25,.46,.45,.94)}
        .video-device.playing .vd-frame{border-color:rgba(255,215,0,0.12);box-shadow:0 16px 60px rgba(0,0,0,0.5),0 0 40px rgba(255,215,0,0.06)}
        .vd-notch{position:absolute;top:8px;left:50%;transform:translateX(-50%);width:44px;height:5px;background:rgba(255,255,255,0.08);border-radius:10px;z-index:3}
        .vd-screen{width:100%;height:100%;position:relative;overflow:hidden}
        /* Shimmer loading effect */
        .vd-screen::after{content:'';position:absolute;inset:0;background:linear-gradient(110deg,transparent 25%,rgba(255,255,255,0.03) 37%,transparent 50%);background-size:200% 100%;z-index:1;animation:shimmer 2.5s infinite;pointer-events:none}
        .video-device.playing .vd-screen::after{opacity:0;transition:opacity .6s}
        @keyframes shimmer{0%{background-position:200% 0}100%{background-position:-200% 0}}
        .vd-screen img{width:100%;height:100%;object-fit:cover;position:absolute;inset:0;transition:opacity 1.2s cubic-bezier(.25,.46,.45,.94)}
        .vd-screen iframe{width:100%;height:100%;border:none;position:absolute;inset:0;opacity:0;transition:opacity 1s cubic-bezier(.25,.46,.45,.94) .3s}
        .video-device.playing .vd-screen iframe{opacity:1}
        /* Play button */
        .vd-play{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;z-index:2;background:rgba(0,0,0,0.15);transition:all .6s cubic-bezier(.25,.46,.45,.94)}
        .vd-play.hidden{opacity:0;pointer-events:none;transform:scale(.8)}
        .vd-play-ring{width:52px;height:52px;border-radius:50%;border:2px solid rgba(255,215,0,0.5);display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0.3);backdrop-filter:blur(8px);transition:all .4s cubic-bezier(.25,.46,.45,.94);animation:ringPulse 3s infinite ease-in-out}
        @keyframes ringPulse{0%,100%{box-shadow:0 0 0 0 rgba(255,215,0,0.2)}50%{box-shadow:0 0 0 12px rgba(255,215,0,0)}}
        .video-device:hover .vd-play-ring{border-color:rgba(255,215,0,0.9);background:rgba(255,215,0,0.15);transform:scale(1.1)}
        .vd-play-ring::after{content:'';width:0;height:0;border-left:18px solid rgba(255,215,0,0.9);border-top:11px solid transparent;border-bottom:11px solid transparent;margin-left:4px}
        /* Bottom bar */
        .vd-bar{position:absolute;bottom:0;left:0;right:0;padding:10px 14px;background:linear-gradient(transparent,rgba(0,0,0,0.85));z-index:2;display:flex;align-items:center;gap:8px;opacity:.8;transition:opacity .4s}
        .video-device.playing .vd-bar{opacity:1}
        .vd-bar-dot{width:5px;height:5px;background:#FF0000;border-radius:50%;transition:all .3s}
        .video-device.playing .vd-bar-dot{animation:recDot 1.5s infinite}
        @keyframes recDot{0%,100%{opacity:1}50%{opacity:.3}}
        .vd-bar span{font-size:9px;color:rgba(255,255,255,0.7);letter-spacing:.5px;text-transform:uppercase}
        /* Cinema Modal */
        .video-modal{position:fixed;inset:0;z-index:9999;background:rgba(0,0,0,0);display:none;align-items:center;justify-content:center;backdrop-filter:blur(0px);transition:background .4s ease,backdrop-filter .4s ease}
        .video-modal.open{display:flex;background:rgba(0,0,0,0.95);backdrop-filter:blur(16px)}
        .video-modal-frame{width:min(380px,88vw);aspect-ratio:9/16;border-radius:20px;overflow:hidden;position:relative;box-shadow:0 0 120px rgba(255,215,0,0.08),0 40px 100px rgba(0,0,0,0.7);transform:scale(.9);opacity:0;transition:all .4s cubic-bezier(.16,1,.3,1)}
        .video-modal.open .video-modal-frame{transform:scale(1);opacity:1}
        .video-modal-frame iframe{width:100%;height:100%;border:none}
        .video-modal-close{position:absolute;top:16px;right:16px;width:36px;height:36px;background:rgba(0,0,0,0.5);backdrop-filter:blur(8px);border:1px solid rgba(255,255,255,0.1);border-radius:50%;color:#fff;font-size:16px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .3s;z-index:10}
        .video-modal-close:hover{background:rgba(255,215,0,0.2);border-color:rgba(255,215,0,0.3);transform:scale(1.1)}
        @media(max-width:900px){.video-showcase{flex-direction:column;text-align:center;gap:28px;padding:28px 24px}.video-copy p{max-width:none}.video-copy .vc-stats{justify-content:center}.vd-frame{width:140px;height:248px}}
        .video-showcase.hidden{display:none}

        .services-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:20px}
        @media(max-width:1024px){.services-grid{grid-template-columns:1fr}}
        .svc-card{position:relative;background:var(--dark-void);border:1px solid rgba(255,255,255,0.05);border-radius:20px;overflow:hidden;transition:all .4s;display:flex;flex-direction:column}
        .svc-card:hover{transform:translateY(-5px);box-shadow:0 20px 50px rgba(0,0,0,0.4)}
        .svc-card.featured{border-color:rgba(255,215,0,0.15)}
        .svc-card.featured:hover{border-color:rgba(255,215,0,0.35)}
        .svc-popular{position:absolute;top:0;left:0;right:0;padding:6px;text-align:center;background:var(--gold);color:#000;font-size:10px;font-weight:800;letter-spacing:1.5px;text-transform:uppercase}
        .svc-top{padding:32px 28px 0;flex:1}
        .svc-card.featured .svc-top{padding-top:44px}
        .svc-badge{display:inline-flex;padding:6px 14px;border-radius:8px;font-size:10px;font-weight:700;letter-spacing:.5px;text-transform:uppercase;margin-bottom:14px}
        .svc-badge-pfs{background:rgba(255,215,0,0.1);color:var(--gold)}
        .svc-badge-das{background:rgba(0,206,209,0.1);color:#00CED1}
        .svc-badge-vv{background:rgba(255,107,107,0.1);color:#FF6B6B}
        .svc-card h3{font-size:20px;font-weight:400;margin-bottom:6px}
        .svc-card .desc{font-size:13px;color:var(--text-secondary);line-height:1.6;margin-bottom:18px}
        .svc-price{display:flex;align-items:baseline;gap:8px;margin-bottom:18px}
        .svc-price strong{font-size:28px;font-weight:200;color:var(--gold)}
        .svc-price span{font-size:12px;color:var(--text-fade)}
        .svc-features{list-style:none;padding:0;margin:0}
        .svc-features li{display:flex;gap:10px;padding:5px 0;font-size:13px;color:var(--text-secondary)}
        .svc-features li::before{content:'‚úì';color:var(--gold);font-weight:700;flex-shrink:0}
        .svc-bottom{padding:20px 28px;border-top:1px solid rgba(255,255,255,0.04);margin-top:auto}
        .svc-cta{display:block;text-align:center;padding:14px;border-radius:12px;font-size:14px;font-weight:600;text-decoration:none;transition:all .3s}
        .svc-cta-gold{background:var(--gold);color:#000}
        .svc-cta-gold:hover{box-shadow:0 8px 30px rgba(255,215,0,0.3)}
        .svc-cta-outline{background:transparent;border:1px solid rgba(255,255,255,0.1);color:var(--text-secondary)}
        .svc-cta-outline:hover{border-color:var(--gold);color:var(--gold)}

        /* FOOTER */
        footer{background:var(--dark-void);border-top:1px solid rgba(255,255,255,0.05);padding:60px 40px 30px}
        .footer-content{max-width:1400px;margin:0 auto;display:grid;grid-template-columns:2fr 1fr 1fr 1fr;gap:40px}
        @media(max-width:768px){.footer-content{grid-template-columns:1fr;gap:30px}footer{padding:40px 20px 20px}}
        .footer-brand h3{font-family:'Helvetica Neue',Helvetica,Arial,sans-serif;font-size:24px;font-weight:300;letter-spacing:4px;margin-bottom:12px}
        .footer-brand p{font-size:13px;color:var(--text-fade);line-height:1.8}
        .footer-col h4{font-size:11px;text-transform:uppercase;letter-spacing:2px;color:var(--text-secondary);margin-bottom:16px}
        .footer-col a{display:block;font-size:13px;color:var(--text-fade);margin-bottom:10px;transition:color .3s}
        .footer-col a:hover{color:var(--gold)}
        .footer-bottom{max-width:1400px;margin:30px auto 0;padding-top:20px;border-top:1px solid rgba(255,255,255,0.05);text-align:center;font-size:12px;color:var(--text-fade)}
    </style>
</head>
<body>

    <!-- NAV -->
    <nav>
        <div class="nav-container">
            <a href="/" class="logo">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024" class="logo-svg">
                    <defs>
                      <linearGradient id="goldGradientNav" x1="0%" y1="0%" x2="0%" y2="100%">
                        <stop offset="0%" stop-color="#FFD54F"/>
                        <stop offset="100%" stop-color="#F5A623"/>
                      </linearGradient>
                    </defs>
                    <g transform="translate(0,1024) scale(0.1,-0.1)" fill="url(#goldGradientNav)">
                      <path d="M4860 8749 c-509 -29 -976 -161 -1413 -401 -580 -317 -1057 -806 -1350 -1383 -148 -292 -229 -532 -291 -859 -89 -465 -69 -1005 54 -1461 184 -688 616 -1308 1232 -1769 492 -368 1172 -609 1794 -635 546 -22 987 57 1489 267 503 211 979 589 1327 1053 340 453 557 994 630 1569 17 135 17 630 0 760 -93 716 -396 1341 -900 1861 -280 289 -569 498 -922 667 -416 200 -813 303 -1285 332 -165 10 -170 10 -365 -1z m610 -144 c743 -103 1436 -459 1919 -985 338 -367 562 -751 704 -1205 276 -879 132 -1858 -388 -2640 -242 -364 -493 -615 -900 -900 l-70 -49 109 104 c413 396 679 919 767 1505 33 217 33 558 0 765 -75 476 -257 896 -549 1265 -127 161 -363 380 -549 511 -300 211 -689 363 -1079 420 -172 26 -604 26 -764 0 -296 -47 -545 -128 -808 -262 -236 -122 -440 -271 -632 -464 -486 -485 -749 -1121 -751 -1815 -1 -611 170 -1148 515 -1608 100 -134 286 -335 382 -413 33 -27 -8 -2 -91 55 -513 351 -904 805 -1143 1331 -71 156 -136 336 -168 465 -9 33 -19 76 -24 95 -5 19 -20 100 -34 180 -59 343 -60 740 0 1070 81 456 229 826 479 1200 246 368 558 669 949 917 386 245 881 418 1321 462 61 6 124 13 140 15 73 10 556 -4 665 -19z m-60 -1329 c105 -16 258 -49 335 -72 82 -26 197 -66 240 -84 149 -65 190 -84 266 -126 677 -379 1129 -1049 1246 -1849 27 -182 24 -517 -5 -695 -75 -458 -225 -813 -500 -1179 -116 -154 -340 -369 -527 -506 -44 -32 -87 -63 -95 -69 -8 -6 35 39 96 99 178 177 283 321 397 550 161 322 231 676 205 1045 -32 467 -223 902 -542 1237 -239 251 -521 426 -873 542 -79 26 -273 67 -383 81 -108 13 -349 13 -465 0 -276 -32 -597 -145 -834 -293 -224 -140 -466 -378 -613 -602 -307 -470 -407 -1055 -273 -1599 80 -327 217 -589 454 -871 71 -84 73 -88 31 -56 -293 225 -547 535 -718 877 -34 68 -65 143 -122 294 -42 112 -101 383 -120 555 -14 127 -14 401 0 534 51 482 223 912 516 1288 269 344 654 620 1085 778 160 59 400 115 574 134 121 13 508 5 625 -13z m-30 -1165 c401 -81 721 -242 992 -499 643 -612 769 -1607 300 -2367 -118 -190 -291 -386 -463 -524 -137 -111 -148 -113 -49 -12 110 112 206 248 275 386 67 137 98 222 132 367 24 103 26 132 27 323 0 182 -3 224 -22 310 -47 211 -126 394 -245 569 -126 186 -358 387 -564 490 -384 191 -823 225 -1218 95 -482 -160 -854 -541 -1004 -1029 -117 -379 -81 -810 96 -1165 37 -72 130 -215 166 -252 17 -18 26 -33 20 -33 -6 0 -61 52 -121 116 -259 272 -424 575 -511 934 -111 459 -18 1006 245 1430 298 483 791 797 1379 880 110 16 448 4 565 -19z m-239 -911 c360 -28 680 -171 925 -415 194 -193 317 -415 382 -688 24 -102 26 -130 26 -312 0 -191 -1 -205 -30 -320 -53 -205 -132 -372 -251 -535 -58 -79 -263 -288 -323 -330 -31 -22 -29 -18 18 35 195 220 312 519 312 795 0 325 -121 614 -350 841 -369 364 -926 453 -1385 222 -336 -170 -578 -499 -636 -865 -19 -126 -7 -371 25 -490 44 -162 97 -284 173 -398 9 -14 -4 -5 -30 20 -26 24 -45 51 -42 58 2 7 1 11 -4 7 -11 -6 -58 51 -118 140 -109 163 -183 347 -219 545 -23 127 -23 351 -1 489 55 335 248 677 492 871 261 208 530 311 881 338 11 1 81 -3 155 -8z m29 -714 c459 -74 823 -428 895 -869 58 -358 -60 -696 -345 -987 l-34 -35 22 35 c115 182 179 403 168 575 -14 235 -104 433 -268 591 -137 134 -287 209 -472 239 -115 19 -187 19 -303 0 -337 -55 -612 -302 -704 -635 -32 -113 -34 -325 -5 -440 23 -92 70 -213 98 -254 l21 -31 -31 29 c-39 36 -120 152 -155 221 -35 71 -81 215 -102 319 -25 130 -17 357 17 476 102 354 357 618 706 730 152 49 331 62 492 36z m-73 -567 c178 -24 327 -101 454 -236 137 -143 199 -303 201 -513 1 -162 -42 -309 -135 -453 -52 -82 -73 -97 -38 -28 51 99 67 290 36 412 -57 219 -251 413 -466 464 -75 17 -236 20 -311 4 -213 -44 -422 -247 -473 -460 -31 -133 -13 -325 41 -431 35 -70 8 -47 -52 43 -58 88 -90 167 -114 286 -25 121 -25 220 -1 331 33 146 84 243 186 351 171 183 413 266 672 230z m15 -470 c80 -17 186 -76 248 -139 106 -107 158 -248 147 -398 -6 -92 -25 -152 -79 -250 -45 -82 -60 -91 -27 -17 18 41 21 62 17 149 -4 89 -8 108 -35 162 -43 82 -126 165 -209 205 -58 29 -80 34 -158 37 -112 5 -184 -12 -259 -62 -182 -121 -251 -323 -171 -506 l24 -55 -25 30 c-36 44 -92 162 -104 223 -39 189 14 369 146 492 105 99 204 139 345 139 48 1 111 -4 140 -10z"/>
                    </g>
                  </svg>
                <span class="logo-text">BOOM</span>
            </a>
            <div class="nav-links">
                <a href="/apartments.html" class="active">Apartments</a>
                <a href="/property-finding.html">Property Finding</a>
                <a href="/deal-assistance.html">Deal Assistance</a>
                <a href="/virtual-viewing.html">Virtual Viewing</a>
                <a href="/concierge.html">Concierge</a>
                <a href="/about.html">About</a>
                <a href="https://wa.me/393313251961" class="wa-link">WhatsApp</a>
            </div>
            <div class="hamburger" id="hamburger"><span></span><span></span><span></span></div>
        </div>
    </nav>

    <div class="mobile-menu" id="mobileMenu">
        <a href="/">Home</a>
        <a href="/apartments.html">Apartments</a>
        <a href="/property-finding.html">Property Finding</a>
        <a href="/deal-assistance.html">Deal Assistance</a>
        <a href="/virtual-viewing.html">Virtual Viewing</a>
        <a href="/concierge.html">Concierge</a>
        <a href="/about.html">About</a>
        <a href="/login.html">Login</a>
        <a href="https://wa.me/393313251961" class="wa-mob">WhatsApp Us</a>
    </div>

    <div class="page">
        <div class="page-header">
            <div class="page-tag">Available Now</div>
            <h1 class="page-title">Apartments in Rome</h1>
            <p class="page-subtitle">All verified. All real. All ready. Updated daily from our portfolio.</p>
        </div>

        <div class="filters" id="filters">
            <button class="filter-btn active" data-filter="all">All</button>
            <button class="filter-btn" data-filter="available">Available</button>
            <button class="filter-btn" data-filter="waitlist">Coming Soon</button>
        </div>

        <div id="listingsContainer">
            <div class="loading-state" id="loadingState">
                <div class="spinner"></div>
                <p style="color:var(--text-secondary)">Loading apartments‚Ä¶</p>
            </div>
        </div>

        <!-- UPSELL SECTION -->
        <div class="upsell-section">
            <div class="upsell-header">
                <span class="upsell-tag">How Can We Help</span>
                <h2 class="upsell-title">Not finding what you need?</h2>
                <p class="upsell-subtitle">Whether you need us to find, verify, or negotiate ‚Äî we've got the right service for every stage of your search.</p>
            </div>

            <div class="notify-banner">
                <div class="notify-icon">üîî</div>
                <div class="notify-text">
                    <h3>Get Notified When We Find a Match</h3>
                    <p>Tell us your requirements ‚Äî budget, zone, move-in date ‚Äî and we'll reach out when something fits. No commitment, no spam.</p>
                </div>
                <div class="notify-actions">
                    <a href="https://wa.me/393313251961?text=Hi%20BOOM%2C%20I%27m%20looking%20for%20an%20apartment%20in%20Rome.%20Here%20are%20my%20requirements%3A%0A%0ABudget%3A%20%0AZone%3A%20%0AMove-in%3A%20%0ABedrooms%3A%20" class="nbtn nbtn-wa" target="_blank">üí¨ WhatsApp Us</a>
                    <a href="https://boom-property-dashboards.web.app/onboarding.html" class="nbtn nbtn-primary">üìã Fill the Form</a>
                </div>
            </div>

            <!-- VIDEO SHOWCASE ‚Äî Living Phone, Firestore-powered -->
            <div class="video-showcase" id="videoShowcase">
                <div class="video-copy">
                    <div class="vc-tag"><span class="pulse"></span> Watch</div>
                    <h3>See how <strong>BOOM</strong> works<br>in 30 seconds</h3>
                    <p>Real footage. Real apartments. Real team on the ground in Rome ‚Äî not stock photos and algorithms.</p>
                    <div class="vc-stats">
                        <div class="vc-stat"><span>48h</span> move-in</div>
                        <div class="vc-stat"><span>98%</span> success</div>
                        <div class="vc-stat"><span>500+</span> placed</div>
                    </div>
                </div>
                <div class="video-device" id="videoDevice" onclick="openCinema()">
                    <div class="vd-glow"></div>
                    <div class="vd-frame">
                        <div class="vd-notch"></div>
                        <div class="vd-screen" id="vdScreen">
                            <img id="vdThumb" alt="BOOM Rome">
                            <div class="vd-play" id="vdPlay"><div class="vd-play-ring"></div></div>
                            <div class="vd-bar"><div class="vd-bar-dot"></div><span>BOOM Rome</span></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Cinema Modal -->
            <div class="video-modal" id="videoModal" onclick="closeCinema(event)">
                <div class="video-modal-frame">
                    <button class="video-modal-close" onclick="closeCinema(event)">‚úï</button>
                    <div id="cinemaContainer"></div>
                </div>
            </div>

            <div class="services-grid">
                <div class="svc-card featured">
                    <div class="svc-popular">Most Popular</div>
                    <div class="svc-top">
                        <span class="svc-badge svc-badge-pfs">üîç Full Search</span>
                        <h3>Property Finding</h3>
                        <p class="desc">We search the entire Rome market for you ‚Äî portals, off-market, landlord network. Curated shortlist within 10 days.</p>
                        <div class="svc-price"><strong>‚Ç¨350</strong><span>upfront ¬∑ deducted from agency fee</span></div>
                        <ul class="svc-features">
                            <li>Dedicated agent searching for you</li>
                            <li>Access to off-market properties</li>
                            <li>Curated shortlist in 10 days</li>
                            <li>Video tour of every option</li>
                            <li>Full refund if we don't deliver</li>
                        </ul>
                    </div>
                    <div class="svc-bottom"><a href="/property-finding.html" class="svc-cta svc-cta-gold">Start Property Finding ‚Üí</a></div>
                </div>

                <div class="svc-card">
                    <div class="svc-top">
                        <span class="svc-badge svc-badge-das">ü§ù Contract Help</span>
                        <h3>Deal Assistance</h3>
                        <p class="desc">Found a place yourself? We review the contract, verify the landlord, negotiate terms, and protect you from scams.</p>
                        <div class="svc-price"><strong>‚Ç¨249</strong><span>fixed fee ¬∑ no surprises</span></div>
                        <ul class="svc-features">
                            <li>Contract review &amp; translation</li>
                            <li>Landlord &amp; property verification</li>
                            <li>Price &amp; terms negotiation</li>
                            <li>Red flag identification</li>
                            <li>Deposit protection advice</li>
                        </ul>
                    </div>
                    <div class="svc-bottom"><a href="/deal-assistance.html" class="svc-cta svc-cta-outline">Learn More ‚Üí</a></div>
                </div>

                <div class="svc-card">
                    <div class="svc-top">
                        <span class="svc-badge svc-badge-vv">üìπ Remote Viewing</span>
                        <h3>Virtual Viewing</h3>
                        <p class="desc">Can't visit in person? We go for you ‚Äî live HD video walkthrough with real-time Q&amp;A and an honest assessment report.</p>
                        <div class="svc-price"><strong>‚Ç¨89</strong><span>per viewing ¬∑ from abroad</span></div>
                        <ul class="svc-features">
                            <li>Live HD video walkthrough</li>
                            <li>Real-time Q&amp;A with our agent</li>
                            <li>Neighborhood &amp; building check</li>
                            <li>Detailed written report</li>
                            <li>Honest go / no-go recommendation</li>
                        </ul>
                    </div>
                    <div class="svc-bottom"><a href="/virtual-viewing.html" class="svc-cta svc-cta-outline">Learn More ‚Üí</a></div>
                </div>
            </div>
        </div>
    </div>

    <!-- FOOTER -->
    <footer>
        <div class="footer-content">
            <div class="footer-brand">
                <h3>BOOM</h3>
                <p>Built in Rome, for Rome. If we can make Rome's rental market work, we can make it work anywhere.</p>
                <p style="margin-top:12px"><strong>Egidi Immobiliare S.r.l.</strong><br>P.IVA 17322991005<br>REA RM - 1710623<br>Rome, Italy</p>
            </div>
            <div class="footer-col">
                <h4>Services</h4>
                <a href="/apartments.html">Apartments</a>
                <a href="/property-finding.html">Property Finding</a>
                <a href="/deal-assistance.html">Deal Assistance</a>
                <a href="/virtual-viewing.html">Virtual Viewing</a>
                <a href="/concierge.html">Concierge</a>
            </div>
            <div class="footer-col">
                <h4>Company</h4>
                <a href="/about.html">About</a>
                <a href="/how-it-works.html">How It Works</a>
                <a href="/owners.html">For Owners</a>
                <a href="/blog.html">Blog</a>
                <a href="/faq.html">FAQ</a>
                <a href="/contact.html">Contact</a>
            </div>
            <div class="footer-col">
                <h4>Legal</h4>
                <a href="/terms.html">Terms</a>
                <a href="/privacy.html">Privacy</a>
                <a href="/login.html">Login</a>
            </div>
        </div>
        <div class="footer-bottom">¬© 2025 BOOM ‚Äî All Rights Reserved</div>
    </footer>

    <!-- FIREBASE -->
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>
    <script>
    // Same Firebase project as portal.html (boom-property-dashboards)
    firebase.initializeApp({
        apiKey:"AIzaSyDDb8UeSc8RhO_VxQrhLrupu1aPD4rwRso",
        authDomain:"boom-property-dashboards.firebaseapp.com",
        projectId:"boom-property-dashboards",
        storageBucket:"boom-property-dashboards.firebasestorage.app",
        messagingSenderId:"937269017440",
        appId:"1:937269017440:web:41c1a0b1e1633c2f373c05"
    });
    const db = firebase.firestore();

    let allListings = [];
    let currentFilter = 'all';

    // Hamburger
    document.getElementById('hamburger').addEventListener('click', () => {
        document.getElementById('mobileMenu').classList.toggle('open');
    });
    document.querySelectorAll('.mobile-menu a').forEach(a => {
        a.addEventListener('click', () => document.getElementById('mobileMenu').classList.remove('open'));
    });

    // Filters
    document.querySelectorAll('.filter-btn').forEach(btn => {
        btn.addEventListener('click', () => {
            document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            currentFilter = btn.dataset.filter;
            renderListings();
        });
    });

    // Load listings from Firebase
    async function loadListings() {
        try {
            const snapshot = await db.collection('listings').get();
            allListings = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
            
            // Update filter counts
            const available = allListings.filter(l => l.status === 'available').length;
            const waitlist = allListings.filter(l => l.status === 'waitlist').length;
            const visible = available + waitlist;
            
            document.querySelectorAll('.filter-btn').forEach(btn => {
                const f = btn.dataset.filter;
                let count = 0;
                if (f === 'all') count = visible;
                else if (f === 'available') count = available;
                else if (f === 'waitlist') count = waitlist;
                // Add count badge
                const existing = btn.querySelector('.filter-count');
                if (existing) existing.remove();
                if (count > 0) {
                    const span = document.createElement('span');
                    span.className = 'filter-count';
                    span.textContent = count;
                    btn.appendChild(span);
                }
            });

            renderListings();
        } catch (err) {
            console.error('Error loading listings:', err);
            document.getElementById('listingsContainer').innerHTML = `
                <div class="empty-state">
                    <h3>Connection Error</h3>
                    <p>Could not load apartments. Please refresh the page.</p>
                </div>`;
        }
    }

    function renderListings() {
        const container = document.getElementById('listingsContainer');
        
        // Filter: hide rented, show available + waitlist
        let filtered = allListings.filter(l => l.status === 'available' || l.status === 'waitlist');
        
        if (currentFilter === 'available') {
            filtered = filtered.filter(l => l.status === 'available');
        } else if (currentFilter === 'waitlist') {
            filtered = filtered.filter(l => l.status === 'waitlist');
        }

        // Sort: available first, then by price ascending
        filtered.sort((a, b) => {
            if (a.status === 'available' && b.status !== 'available') return -1;
            if (a.status !== 'available' && b.status === 'available') return 1;
            return (a.price || 0) - (b.price || 0);
        });

        if (filtered.length === 0) {
            container.innerHTML = `
                <div class="empty-state">
                    <h3>No apartments available right now</h3>
                    <p>New listings are added frequently. Try our Property Finding Service and we'll search for you.</p>
                    <a href="/property-finding.html" style="display:inline-block;margin-top:16px;padding:14px 32px;background:var(--gold);color:#000;border-radius:12px;font-weight:600;font-size:14px">Start Property Finding ‚Üí</a>
                </div>`;
            return;
        }

        container.innerHTML = `<div class="grid">${filtered.map(l => cardHTML(l)).join('')}</div>`;
    }

    function cardHTML(l) {
        const imgUrl = l.image || 'https://via.placeholder.com/400x220/111111/333333?text=Photo+Coming+Soon';
        const beds = l.beds || (l.bedrooms ? (l.bedrooms === 0 ? 'Studio' : l.bedrooms + ' Bed') : '');
        const sqm = l.size || (l.sqm ? l.sqm + 'm¬≤' : '');
        const price = l.price ? `‚Ç¨${Number(l.price).toLocaleString()}` : '‚Äî';
        
        // Determine link: use l.file if set, otherwise apartment-detail.html?id=
        let link = l.file || `apartment-detail.html?id=${l.id}`;
        if (link && !link.startsWith('http') && !link.startsWith('/')) link = '/' + link;
        
        const statusBadge = l.status === 'available' 
            ? '<span class="badge badge-available">Available</span>' 
            : '<span class="badge badge-waitlist">Coming Soon</span>';
        
        const verifiedBadge = '<span class="badge badge-verified">‚úì Verified</span>';
        const videoBadge = l.videoUrl ? '<span class="badge badge-video">‚ñ∂ Video</span>' : '';
        
        // Tags (max 3)
        const tags = Array.isArray(l.tags) ? l.tags.slice(0, 3) : [];
        const tagsHTML = tags.length ? `<div class="card-tags">${tags.map(t => `<span class="card-tag">${t}</span>`).join('')}</div>` : '';
        
        // Specs
        const specs = [];
        if (beds) specs.push(`<span>üõèÔ∏è ${beds}</span>`);
        if (sqm) specs.push(`<span>üìê ${sqm}</span>`);
        if (l.floor) specs.push(`<span>üè¢ ${l.floor}</span>`);
        if (l.type) specs.push(`<span>${l.type}</span>`);
        
        const availDate = l.availableDate ? `<div class="card-avail">Available: ${l.availableDate}</div>` : '';

        return `<a href="${link}" class="card">
            <div class="card-img" style="background-image:url('${imgUrl}')">
                <div class="card-badges">${statusBadge}${verifiedBadge}${videoBadge}</div>
            </div>
            <div class="card-body">
                ${l.zone ? `<div class="card-zone">${l.zone}</div>` : ''}
                <div class="card-name">${l.name || 'Apartment'}</div>
                ${specs.length ? `<div class="card-specs">${specs.join('')}</div>` : ''}
                ${tagsHTML}
                <div class="card-bottom">
                    <div class="card-price">${price} <small>/month</small></div>
                    <div class="card-cta">View Details</div>
                </div>
                ${availDate}
            </div>
        </a>`;
    }

    // Init
    loadListings();
    </script>

    <!-- Video ‚Äî Firestore-powered, autoplay on scroll, cinema on click -->
    <script>
    let boomVideoId = 'xb1OON-bhK4'; // fallback
    let inlinePlayer = null;

    // Load video ID from Firestore settings
    function loadVideoSetting() {
        if (typeof db === 'undefined') { initVideo(boomVideoId); return; }
        db.collection('settings').doc('video').get().then(doc => {
            if (doc.exists && doc.data().youtubeId) {
                boomVideoId = doc.data().youtubeId;
                initVideo(boomVideoId);
            } else if (doc.exists && doc.data().url) {
                const url = doc.data().url;
                const m = url.match(/(?:shorts\/|watch\?v=|embed\/|youtu\.be\/)([a-zA-Z0-9_-]{11})/);
                if (m) { boomVideoId = m[1]; initVideo(boomVideoId); }
                else { document.getElementById('videoShowcase').classList.add('hidden'); }
            } else {
                document.getElementById('videoShowcase').classList.add('hidden');
            }
        }).catch(() => initVideo(boomVideoId));
    }

    function initVideo(vid) {
        const showcase = document.getElementById('videoShowcase');
        const device = document.getElementById('videoDevice');
        if (!vid) { showcase.classList.add('hidden'); return; }

        // Set thumbnail with maxres quality
        const thumb = document.getElementById('vdThumb');
        const maxres = new Image();
        maxres.onload = () => { thumb.src = maxres.src; };
        maxres.onerror = () => { thumb.src = 'https://img.youtube.com/vi/' + vid + '/hqdefault.jpg'; };
        maxres.src = 'https://img.youtube.com/vi/' + vid + '/maxresdefault.jpg';

        // Entrance animation ‚Äî fade in when showcase enters viewport
        const entranceObs = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    showcase.classList.add('visible');
                    entranceObs.disconnect();
                }
            });
        }, { threshold: 0.15 });
        entranceObs.observe(showcase);

        // Autoplay muted in phone when 30% visible
        const playObs = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting && !inlinePlayer) {
                    // Small delay for smooth sequencing after entrance animation
                    setTimeout(() => {
                        const screen = document.getElementById('vdScreen');
                        const iframe = document.createElement('iframe');
                        iframe.src = 'https://www.youtube.com/embed/' + vid + '?autoplay=1&mute=1&loop=1&playlist=' + vid + '&controls=0&showinfo=0&rel=0&playsinline=1&modestbranding=1&iv_load_policy=3';
                        iframe.allow = 'autoplay;encrypted-media';
                        iframe.loading = 'lazy';
                        screen.insertBefore(iframe, screen.querySelector('.vd-play'));
                        inlinePlayer = iframe;

                        // Smooth transition: fade iframe in, fade thumbnail out, activate playing state
                        iframe.onload = () => {
                            // Wait a beat for YouTube to actually start rendering
                            setTimeout(() => {
                                device.classList.add('playing');
                                thumb.style.opacity = '0';
                                document.getElementById('vdPlay').classList.add('hidden');
                            }, 800);
                        };
                    }, 600);
                    playObs.disconnect();
                }
            });
        }, { threshold: 0.3 });
        playObs.observe(showcase);
    }

    function openCinema() {
        const m = document.getElementById('videoModal');
        const c = document.getElementById('cinemaContainer');
        m.style.display = 'flex';
        // Force reflow for animation
        requestAnimationFrame(() => {
            requestAnimationFrame(() => {
                m.classList.add('open');
            });
        });
        c.innerHTML = '<iframe src="https://www.youtube.com/embed/' + boomVideoId + '?autoplay=1&rel=0&modestbranding=1&playsinline=1" allow="autoplay;encrypted-media;fullscreen" allowfullscreen></iframe>';
        document.body.style.overflow = 'hidden';
        if (inlinePlayer) inlinePlayer.src = '';
    }

    function closeCinema(e) {
        if (e && e.target.closest('.video-modal-frame') && !e.target.closest('.video-modal-close')) return;
        const m = document.getElementById('videoModal');
        m.classList.remove('open');
        // Wait for exit animation, then cleanup
        setTimeout(() => {
            document.getElementById('cinemaContainer').innerHTML = '';
            m.style.display = 'none';
            document.body.style.overflow = '';
            // Resume inline silently
            if (inlinePlayer) {
                inlinePlayer.src = 'https://www.youtube.com/embed/' + boomVideoId + '?autoplay=1&mute=1&loop=1&playlist=' + boomVideoId + '&controls=0&showinfo=0&rel=0&playsinline=1&modestbranding=1&iv_load_policy=3';
            }
        }, 400);
    }

    document.addEventListener('keydown', e => { if (e.key === 'Escape') closeCinema(e); });

    // Init after Firebase is ready
    if (typeof db !== 'undefined') {
        loadVideoSetting();
    } else {
        window.addEventListener('load', () => {
            setTimeout(loadVideoSetting, 500);
        });
    }
    </script>
</body>
</html>
