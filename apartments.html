<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Available Apartments - BOOM Rome</title>
    <meta name="description" content="Browse verified apartments in Rome. Real photos, transparent pricing, immediate availability.">
    <link rel="icon" type="image/png" href="https://www.boomrome.com/BOOMlogogoldicon512.png">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;900&family=Oswald:wght@200;300;400;500&display=swap" rel="stylesheet">
    
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-font-smoothing: antialiased; }
        :root {
            --gold: #FFD700; --cyan: #00CED1; --green: #00FF88; --orange: #FF6B35;
            --purple: #9D4EDD; --red: #FF3B3B; --pure-black: #000000; --dark-void: #0A0A0A;
            --dark-surface: #111111; --text-primary: #FFFFFF; --text-fade: #666666; --text-secondary: #999999;
        }
        body { font-family: 'Inter', -apple-system, sans-serif; background: var(--pure-black); color: var(--text-primary); font-weight: 200; letter-spacing: 0.02em; line-height: 1.6; }
        
        /* NAV */
        nav { position: fixed; width: 100%; top: 0; z-index: 100; padding: 20px 50px; background: rgba(0,0,0,0.98); backdrop-filter: blur(20px); border-bottom: 1px solid rgba(255, 215, 0, 0.1); }
        .nav-container { max-width: 1400px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center; }
        .logo { display: flex; align-items: center; gap: 15px; text-decoration: none; color: white; }
        .logo-svg { width: 40px; height: 40px; filter: drop-shadow(0 0 20px rgba(255, 215, 0, 0.5)); }
        .logo-text { font-family: 'Oswald', sans-serif; font-size: 32px; font-weight: 300; letter-spacing: -2px; text-transform: uppercase; }
        .nav-links { display: flex; gap: 40px; align-items: center; }
        .nav-link { color: var(--text-secondary); text-decoration: none; font-size: 11px; text-transform: uppercase; letter-spacing: 2px; transition: color 0.3s; font-weight: 400; }
        .nav-link:hover, .nav-link.active { color: var(--gold); }
        .nav-cta { padding: 12px 30px; background: transparent; border: 1px solid var(--gold); color: var(--gold); text-decoration: none; font-size: 11px; letter-spacing: 2px; text-transform: uppercase; transition: all 0.3s; font-weight: 500; }
        .nav-cta:hover { background: var(--gold); color: var(--pure-black); }
        
        /* HERO */
        .apartments-hero { padding: 150px 50px 80px; text-align: center; background: linear-gradient(135deg, rgba(255, 215, 0, 0.03), transparent); }
        .hero-tag { display: inline-block; padding: 8px 20px; background: var(--green); color: var(--pure-black); font-size: 10px; font-weight: 700; letter-spacing: 2px; text-transform: uppercase; margin-bottom: 30px; }
        .hero-title { font-size: clamp(50px, 10vw, 100px); font-weight: 100; line-height: 0.9; letter-spacing: -0.03em; text-transform: uppercase; margin-bottom: 20px; font-family: 'Oswald', sans-serif; }
        .gold-accent { color: var(--gold); font-weight: 300; }
        .hero-subtitle { font-size: 18px; color: var(--text-secondary); max-width: 600px; margin: 0 auto 40px; }
        
        /* STATS BAR */
        .stats-bar { padding: 20px 50px; background: var(--dark-surface); border-bottom: 1px solid rgba(255, 255, 255, 0.05); }
        .stats-container { max-width: 1400px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px; }
        .results-count { font-size: 14px; color: var(--text-secondary); }
        .results-count strong { color: var(--gold); font-weight: 500; }
        .filter-buttons { display: flex; gap: 10px; }
        .filter-btn { padding: 10px 20px; background: transparent; border: 1px solid rgba(255, 255, 255, 0.2); color: var(--text-secondary); cursor: pointer; font-size: 11px; text-transform: uppercase; letter-spacing: 2px; transition: all 0.3s; font-family: inherit; }
        .filter-btn:hover, .filter-btn.active { border-color: var(--gold); color: var(--gold); }
        
        /* APARTMENTS GRID */
        .apartments-section { padding: 60px 50px 100px; }
        .apartments-container { max-width: 1400px; margin: 0 auto; }
        .apartments-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(380px, 1fr)); gap: 30px; }
        
        /* APARTMENT CARD */
        .apartment-card { background: var(--dark-surface); border-radius: 12px; overflow: hidden; transition: all 0.3s; border: 1px solid rgba(255, 255, 255, 0.05); text-decoration: none; color: inherit; display: block; }
        .apartment-card:hover { transform: translateY(-5px); border-color: rgba(255, 215, 0, 0.3); box-shadow: 0 20px 40px rgba(0,0,0,0.4); }
        .apartment-card.waitlist { opacity: 0.7; }
        .apartment-card.waitlist:hover { opacity: 1; }
        .apartment-card.hidden { display: none; }
        
        .apartment-image { height: 250px; background-size: cover; background-position: center; position: relative; }
        .apartment-badge { position: absolute; top: 15px; left: 15px; padding: 6px 12px; background: var(--gold); color: var(--pure-black); font-size: 9px; font-weight: 700; letter-spacing: 1px; text-transform: uppercase; }
        .apartment-status { position: absolute; bottom: 15px; right: 15px; padding: 8px 15px; font-size: 11px; font-weight: 500; letter-spacing: 1px; text-transform: uppercase; border-radius: 4px; }
        .apartment-status.available { background: var(--green); color: var(--pure-black); }
        .apartment-status.waitlist { background: rgba(255, 107, 53, 0.9); color: white; }
        .apartment-status.rented { background: rgba(255, 59, 59, 0.9); color: white; }
        
        .apartment-info { padding: 25px; }
        .apartment-price { margin-bottom: 10px; }
        .price-amount { font-size: 28px; font-weight: 300; color: var(--gold); }
        .price-period { font-size: 14px; color: var(--text-fade); }
        .apartment-title { font-size: 22px; font-weight: 400; margin-bottom: 5px; }
        .apartment-address { font-size: 13px; color: var(--text-secondary); margin-bottom: 15px; }
        .apartment-features { display: flex; gap: 15px; margin-bottom: 15px; flex-wrap: wrap; }
        .feature { font-size: 12px; color: var(--text-secondary); }
        .apartment-highlights { display: flex; gap: 8px; flex-wrap: wrap; margin-bottom: 20px; }
        .highlight-tag { padding: 5px 10px; background: rgba(255, 215, 0, 0.1); color: var(--gold); font-size: 10px; font-weight: 500; letter-spacing: 1px; text-transform: uppercase; border-radius: 3px; }
        .apartment-cta { display: inline-block; color: var(--gold); font-size: 12px; text-transform: uppercase; letter-spacing: 2px; font-weight: 500; }
        
        /* LOADING */
        .loading-state { text-align: center; padding: 100px 20px; }
        .loading-spinner { width: 50px; height: 50px; border: 3px solid rgba(255,215,0,0.2); border-top-color: var(--gold); border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 20px; }
        @keyframes spin { to { transform: rotate(360deg); } }
        .loading-text { color: var(--text-secondary); font-size: 14px; }
        
        /* EMPTY STATE */
        .empty-state { text-align: center; padding: 100px 20px; }
        .empty-icon { font-size: 60px; margin-bottom: 20px; opacity: 0.5; }
        .empty-title { font-size: 24px; font-weight: 300; margin-bottom: 10px; }
        .empty-text { color: var(--text-secondary); }
        
        /* FOOTER */
        footer { background: var(--dark-surface); padding: 80px 50px 40px; border-top: 1px solid rgba(255, 255, 255, 0.05); }
        .footer-grid { max-width: 1400px; margin: 0 auto; display: grid; grid-template-columns: 2fr 1fr 1fr 1fr; gap: 60px; margin-bottom: 60px; }
        .footer-brand h3 { font-family: 'Oswald', sans-serif; font-size: 28px; font-weight: 300; letter-spacing: -1px; margin-bottom: 20px; }
        .footer-brand p { color: var(--text-secondary); font-size: 14px; line-height: 1.8; }
        .footer-links h4 { font-size: 11px; text-transform: uppercase; letter-spacing: 2px; color: var(--gold); margin-bottom: 20px; font-weight: 500; }
        .footer-links ul { list-style: none; }
        .footer-links li { margin-bottom: 12px; }
        .footer-links a { color: var(--text-secondary); text-decoration: none; font-size: 14px; transition: color 0.3s; }
        .footer-links a:hover { color: var(--text-primary); }
        .footer-bottom { max-width: 1400px; margin: 0 auto; padding-top: 40px; border-top: 1px solid rgba(255, 255, 255, 0.05); display: flex; justify-content: space-between; color: var(--text-fade); font-size: 12px; }
        
        /* MOBILE */
        @media (max-width: 768px) {
            nav { padding: 15px 20px; }
            .nav-links { display: none; }
            .apartments-hero { padding: 120px 20px 60px; }
            .hero-title { font-size: 50px; }
            .stats-bar { padding: 15px 20px; }
            .apartments-section { padding: 40px 20px 80px; }
            .apartments-grid { grid-template-columns: 1fr; }
            footer { padding: 60px 20px 30px; }
            .footer-grid { grid-template-columns: 1fr; gap: 40px; }
        }
    </style>
</head>
<body>
    <nav>
        <div class="nav-container">
            <a href="/" class="logo">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024" class="logo-svg">
                    <defs><linearGradient id="goldGrad" x1="0%" y1="0%" x2="0%" y2="100%"><stop offset="0%" stop-color="#FFD54F"/><stop offset="100%" stop-color="#F5A623"/></linearGradient></defs>
                    <g transform="translate(0,1024) scale(0.1,-0.1)" fill="url(#goldGrad)"><path d="M4860 8749 c-509 -29 -976 -161 -1413 -401 -580 -317 -1057 -806 -1350 -1383 -148 -292 -229 -532 -291 -859 -89 -465 -69 -1005 54 -1461 184 -688 616 -1308 1232 -1769 492 -368 1172 -609 1794 -635 546 -22 987 57 1489 267 503 211 979 589 1327 1053 340 453 557 994 630 1569 17 135 17 630 0 760 -93 716 -396 1341 -900 1861 -280 289 -569 498 -922 667 -416 200 -813 303 -1285 332 -165 10 -170 10 -365 -1z"/></g>
                </svg>
                <span class="logo-text">BOOM</span>
            </a>
            <div class="nav-links">
                <a href="/apartments.html" class="nav-link active">Apartments</a>
                <a href="/property-finding.html" class="nav-link">Property Finding</a>
                <a href="/how-it-works.html" class="nav-link">How It Works</a>
                <a href="/about.html" class="nav-link">About</a>
                <a href="/contact.html" class="nav-cta">Contact</a>
            </div>
        </div>
    </nav>

    <section class="apartments-hero">
        <span class="hero-tag" id="heroTag">Loading...</span>
        <h1 class="hero-title">
            <span class="gold-accent">Real</span> Apartments<br>
            <span class="gold-accent">Real</span> Prices
        </h1>
        <p class="hero-subtitle">
            All apartments are real, verified, and ready for immediate move-in. No catfish photos. No surprises.
        </p>
    </section>

    <section class="stats-bar">
        <div class="stats-container">
            <div class="results-count" id="resultsCount">Loading apartments...</div>
            <div class="filter-buttons">
                <button class="filter-btn active" onclick="filterApartments('all')">All</button>
                <button class="filter-btn" onclick="filterApartments('available')">Available</button>
                <button class="filter-btn" onclick="filterApartments('waitlist')">Coming Soon</button>
            </div>
        </div>
    </section>

    <section class="apartments-section">
        <div class="apartments-container">
            <div class="apartments-grid" id="apartmentsGrid">
                <div class="loading-state">
                    <div class="loading-spinner"></div>
                    <div class="loading-text">Loading apartments from database...</div>
                </div>
            </div>
        </div>
    </section>

    <footer>
        <div class="footer-grid">
            <div class="footer-brand">
                <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 20px;">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024" style="width:40px;height:40px;opacity:0.9">
                        <defs><linearGradient id="goldGrad2" x1="0%" y1="0%" x2="0%" y2="100%"><stop offset="0%" stop-color="#FFD54F"/><stop offset="100%" stop-color="#F5A623"/></linearGradient></defs>
                        <g transform="translate(0,1024) scale(0.1,-0.1)" fill="url(#goldGrad2)"><path d="M4860 8749 c-509 -29 -976 -161 -1413 -401 -580 -317 -1057 -806 -1350 -1383 -148 -292 -229 -532 -291 -859 -89 -465 -69 -1005 54 -1461 184 -688 616 -1308 1232 -1769 492 -368 1172 -609 1794 -635 546 -22 987 57 1489 267 503 211 979 589 1327 1053 340 453 557 994 630 1569 17 135 17 630 0 760 -93 716 -396 1341 -900 1861 -280 289 -569 498 -922 667 -416 200 -813 303 -1285 332 -165 10 -170 10 -365 -1z"/></g>
                    </svg>
                    <h3>BOOM</h3>
                </div>
                <p>
                    Built in Rome, for Rome.<br><br>
                    <strong>Egidi Immobiliare S.r.l.</strong><br>
                    P.IVA 17322991005
                </p>
            </div>
            <div class="footer-links">
                <h4>System</h4>
                <ul>
                    <li><a href="/apartments.html">Apartments</a></li>
                    <li><a href="/property-finding.html">Property Finding</a></li>
                    <li><a href="/how-it-works.html">How It Works</a></li>
                </ul>
            </div>
            <div class="footer-links">
                <h4>Company</h4>
                <ul>
                    <li><a href="/about.html">About</a></li>
                    <li><a href="/owners.html">For Owners</a></li>
                    <li><a href="/contact.html">Contact</a></li>
                </ul>
            </div>
            <div class="footer-links">
                <h4>Legal</h4>
                <ul>
                    <li><a href="/terms.html">Terms</a></li>
                    <li><a href="/privacy.html">Privacy</a></li>
                </ul>
            </div>
        </div>
        <div class="footer-bottom">
            <span>¬© 2025 BOOM ‚Äì Rome, Italy</span>
            <span>Status: Operational</span>
        </div>
    </footer>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    
    <script>
        // Firebase Configuration (read-only access for public)
        firebase.initializeApp({
            apiKey: "AIzaSyDDb8UeSc8RhO_VxQrhLrupu1aPD4rwRso",
            authDomain: "boom-property-dashboards.firebaseapp.com",
            projectId: "boom-property-dashboards"
        });
        const db = firebase.firestore();
        
        // State
        let FLATS = [];
        let currentFilter = 'all';
        
        // Load apartments from Firebase
        async function loadApartments() {
            try {
                console.log('Loading apartments from Firebase...');
                const snapshot = await db.collection('listings')
                    .where('status', 'in', ['available', 'waitlist'])
                    .orderBy('price', 'asc')
                    .get();
                
                FLATS = snapshot.docs.map(doc => ({
                    id: doc.id,
                    ...doc.data()
                }));
                
                console.log(`Loaded ${FLATS.length} apartments`);
                renderApartments();
            } catch (error) {
                console.error('Error loading apartments:', error);
                // Fallback to empty state
                document.getElementById('apartmentsGrid').innerHTML = `
                    <div class="empty-state" style="grid-column: 1/-1">
                        <div class="empty-icon">üè†</div>
                        <h3 class="empty-title">No apartments available</h3>
                        <p class="empty-text">Check back soon or contact us for personalized property finding.</p>
                        <a href="/property-finding.html" style="display:inline-block;margin-top:20px;padding:15px 30px;background:var(--gold);color:black;text-decoration:none;font-size:12px;letter-spacing:2px;text-transform:uppercase">Property Finding Service</a>
                    </div>
                `;
                document.getElementById('heroTag').textContent = 'Coming Soon';
                document.getElementById('resultsCount').innerHTML = 'No apartments currently listed';
            }
        }
        
        // Render apartments
        function renderApartments() {
            const grid = document.getElementById('apartmentsGrid');
            
            // Filter based on current filter
            let filtered = FLATS;
            if (currentFilter === 'available') {
                filtered = FLATS.filter(f => f.status === 'available');
            } else if (currentFilter === 'waitlist') {
                filtered = FLATS.filter(f => f.status === 'waitlist');
            }
            
            const available = FLATS.filter(f => f.status === 'available').length;
            const waitlist = FLATS.filter(f => f.status === 'waitlist').length;
            
            // Update stats
            document.getElementById('heroTag').textContent = `${available} Available Now ¬∑ ${waitlist} Coming Soon`;
            document.getElementById('resultsCount').innerHTML = `Showing <strong>${filtered.length} apartments</strong> in Rome`;
            
            if (filtered.length === 0) {
                grid.innerHTML = `
                    <div class="empty-state" style="grid-column: 1/-1">
                        <div class="empty-icon">üîç</div>
                        <h3 class="empty-title">No apartments match your filter</h3>
                        <p class="empty-text">Try a different filter or check back later.</p>
                    </div>
                `;
                return;
            }
            
            // Generate cards
            grid.innerHTML = filtered.map(flat => {
                const tags = flat.tags ? (Array.isArray(flat.tags) ? flat.tags : flat.tags.split(',').map(t => t.trim())) : [];
                const detailPage = flat.file || `apartment-detail.html?id=${flat.id}`;
                
                return `
                <a href="/${detailPage}" class="apartment-card ${flat.status === 'waitlist' ? 'waitlist' : ''}">
                    <div class="apartment-image" style="background-image: url('${flat.image || 'https://via.placeholder.com/400x250/111/333?text=No+Image'}');">
                        <div class="apartment-badge">${flat.type || 'Apartment'}</div>
                        <div class="apartment-status ${flat.status}">
                            ${flat.status === 'available' ? `Available ${flat.availableDate || 'Now'}` : 
                              flat.status === 'waitlist' ? `Waitlist ¬∑ ${flat.availableDate || 'TBD'}` :
                              'Rented'}
                        </div>
                    </div>
                    <div class="apartment-info">
                        <div class="apartment-price">
                            <span class="price-amount">‚Ç¨${(flat.price || 0).toLocaleString()}</span>
                            <span class="price-period">/month</span>
                        </div>
                        <h3 class="apartment-title">${flat.name || 'Unnamed'}</h3>
                        <p class="apartment-address">${flat.address || flat.zone || 'Rome'}</p>
                        
                        <div class="apartment-features">
                            <span class="feature">üõèÔ∏è ${flat.beds || flat.bedrooms + ' Bedroom' || '‚Äî'}</span>
                            <span class="feature">üìê ${flat.size || (flat.sqm ? flat.sqm + 'm¬≤' : '‚Äî')}</span>
                            <span class="feature">üè¢ ${flat.floor || '‚Äî'}</span>
                        </div>

                        <div class="apartment-highlights">
                            ${tags.slice(0, 4).map(tag => `<span class="highlight-tag">${tag}</span>`).join('')}
                        </div>

                        <span class="apartment-cta">View Details ‚Üí</span>
                    </div>
                </a>
            `}).join('');
        }
        
        // Filter function
        function filterApartments(filter) {
            currentFilter = filter;
            
            // Update button states
            document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            renderApartments();
        }
        
        // Initialize
        loadApartments();
        
        // Real-time updates (optional - listen for changes)
        db.collection('listings').onSnapshot(snapshot => {
            console.log('Listings updated, refreshing...');
            loadApartments();
        }, error => {
            console.log('Real-time updates not available:', error.message);
        });
    </script>
</body>
</html>
